<script language="javascript">
    function showhide (id, set) {
        divobj = document.getElementById(id);
        butobj = document.getElementById(id+'button');
        prefobj = document.getElementById(id+'pref');
        if (set == true) {
            if (prefobj.value == '1') {
                divobj.style.display = 'block';
                butobj.value = '<?php print_string("hidesettings") ?>';
            } else {
                divobj.style.display = 'none';
                butobj.value = '<?php print_string("showsettings") ?>...';
            }
        } else {
            if (prefobj.value == '1') {
                divobj.style.display = 'none';
                butobj.value = '<?php print_string("showsettings") ?>...';
                prefobj.value = '0';
            } else {
                divobj.style.display = 'block';
                butobj.value = '<?php print_string("hidesettings") ?>';
                prefobj.value = '1';
            }
        }
    }
</script>




<tr valign="top">
    <td align="right" nowrap>
        <p><b><?php echo $strfilename ?>:</b></p>
    </td>
    <td>
    <?php
        echo "<input name=\"reference\" size=\"90\" value=\"$form->reference\"><br />";
        button_to_popup_window ("/mod/resource/coursefiles.php?id=$form->course", "coursefiles", $strchooseafile, 500, 750, $strchooseafile);
        echo "<input type=\"button\" name=\"searchbutton\" value=\"$strsearch ...\" ".
             "onClick=\"return window.open('$CFG->resource_websearch', 'websearch', 'menubar=1,location=1,directories=1,toolbar=1,scrollbars,resizable,width=800,height=600');\">\n";
    ?>
    </td>
</tr>

<tr><td colspan="2"><hr /></td></tr>

<tr>
    <td align="right"><p><b><?php print_string("display", "resource") ?>:</b></p></td>
    <td>
        <input type="button" value="hide settings" id="windowsettingsbutton" onClick="javascript: return showhide('windowsettings');" />
        <input type="hidden" name="windowsettingspref" id="windowsettingspref" 
               value="<?php echo get_user_preferences('resource_windowsettingspref', $CFG->resource_windowsettings); ?>" />
        <?php helpbutton("window", get_string("display", "resource"), "resource", true) ?>
    </td>
</tr>
<tr><td colspan="2">

    <div id="windowsettings">

<table align="center">


<tr valign="top">

    <td colspan="2">
        <script>
            var popupitems = [<?php echo $popupoptions; ?>];
            var frameitem = [<?php echo $frameoption; ?>];
            var allitems = [<?php echo $alloptions; ?>];
        </script>
        <input type="radio" name="windowpopup" value=0 <?php echo ($windowtype != "popup") ? "checked" : "" ?> 
        onClick="lockoptions('form', 'windowpopup[0]', frameitem); 
        return lockoptions('form', 'windowpopup[1]', popupitems);">
        <b title="<?php print_string("pagedisplay", "resource") ?>"><?php print_string("pagewindow", "resource") ?></b>
        <ul>
            <input type="hidden" name="hframepage" value=0>
            <input type="checkbox" name="framepage" value=1 <?php echo ($form->options == "frame") ? "checked" : "" ?> >
            <?php print_string("frameifpossible", "resource") ?>
        </ul>
    </td>
</tr>

<tr valign="top">
    
    <td colspan="2">
        <input name="windowpopup" type=radio value=1 <?php echo ($windowtype == "popup") ? "checked" : "" ?>
        onclick="lockoptions('form', 'windowpopup[0]', frameitem); 
        return lockoptions('form', 'windowpopup[1]', popupitems);">
        <b title="<?php p($strnewwindowopen) ?>"><?php p($strnewwindow) ?></b>
        <ul>
        <?php
            foreach ($window as $name => $value) {
                if ($name == "height" or $name == "width") {
                    continue;
                }
                echo "<input name=\"h$name\" type=hidden value=0>";
                echo "<input name=\"$name\" type=checkbox value=1 ".$window->$name.">";
                $stringname = "str$name";
                echo $$stringname."<br />";
            }
        ?>

        <input name="hwidth" type=hidden value=0>
        <input name="width" type=text size=4 value="<?php p($window->width) ?>">
        <?php p($strwidth) ?><br />

        <input name="hheight" type=hidden value=0>
        <input name="height" type=text size=4 value="<?php p($window->height) ?>">
        <?php p($strheight) ?><br />
        <?php
            if ($windowtype == "page") {
                echo "<script>";
                echo "lockoptions('form','windowpopup[1]', popupitems);";
                echo "</script>";
            } else {
                echo "<script>";
                echo "lockoptions('form','windowpopup[0]', frameitem);";
                echo "</script>";
            }
        ?>
        </ul>
    </td>
</tr>

</table>

    </div>

</td></tr>


<tr>
    <td align="right"><p><b><?php print_string("parameters", "resource") ?>:</b></p></td>
    <td>
        <input type="button" value="hide settings" id="parametersettingsbutton" onClick="javascript: return showhide('parametersettings');" />
        <input type="hidden" name="parametersettingspref" id="parametersettingspref" 
               value="<?php echo get_user_preferences('resource_parametersettingspref', $CFG->resource_parametersettings); ?>" />
        <?php helpbutton("parameters", get_string("parameters", "resource"), "resource", true) ?>
    </td>
</tr>
<tr><td colspan="2">

    <div id="parametersettings">

<table align="center">

        <tr>
            <td align="center"><p><?php print_string("parameter", "resource") ?></p></td>
            <td align="center"><p><?php print_string("variablename", "resource") ?></p></td>
        </tr>

<?php

for ($i=0; $i < $this->maxparameters; $i++) {
    echo "<tr>\n";
    echo "<td valign=\"top\">\n";
    echo "<select name=\"parameter$i\">\n";
    echo "<option value=\"-\">-- ".get_string('chooseparameter', 'resource')." --</option>\n";
    foreach ($this->parameters as $field=>$fieldarr) {
        if ($fieldarr['value'] === "optgroup") {
            echo "<optgroup label=\"{$fieldarr['langstr']}\">\n";
        } elseif ($fieldarr['value'] === "/optgroup") {
            echo "</optgroup>\n";
        } else {
            echo "<option value=\"$field\"";
            if ($alltextfield[$i]['parameter'] == $field) {
                echo " selected";
            }
            echo ">{$fieldarr['langstr']}</option>\n";
        }
    }
    echo "</td>\n";
    echo "<td valign=\"top\">\n";
    echo "<input type=\"text\" name=\"parse$i\" value=\"{$alltextfield[$i]['parse']}\">\n";
    echo "</td>\n";
    echo "</tr>\n";
}

?>


</table>
    
    </div>
    
</td></tr>



<script language="javascript">
    showhide('parametersettings', true);
    showhide('windowsettings', true);
</script>
