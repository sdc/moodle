<?php
$QTYPES[$question->qtype]->print_question_form_start($question, array(), $course, $usehtmleditor);

// Answers.
    for ($i=1; $i<=count($answers); $i++) {
        $answer = $answers[$i-1];
?>
<tr valign="top">
    <td align="right"><b><?php echo get_string("answer", "quiz")." $i";  ?>:</b></td>
    <td align="left">
        <?php
            if ($answer->answer === '' && !isset($answer->tolerance) && !isset($answer->fraction)) {
                $answervalue = '';
                $answertolerance = '';
                $fractionval = 0;
                $feedbacktext = '';
            } else {
                $answervalue = $answer->answer;
                $answertolerance = $answer->tolerance;
                $fractionval = $answer->fraction;
                $feedbacktext = $answer->feedback;
            }
        ?>
        <input type="text" name="answer[]" size="25" value="<?php p($answervalue); ?>" />&nbsp;&nbsp;
        <?php echo get_string("acceptederror", "quiz"); ?>&nbsp;<input type="text" name="tolerance[]" size="15" value="<?php p($answertolerance) ?>" />&plusmn;&nbsp;&nbsp;
        <?php print_string("grade");
           echo ":&nbsp;";
           choose_from_menu($gradeoptions, "fraction[]", $fractionval,""); ?>
        <br />
    </td>
</tr>
<tr valign="top">
    <td align="right"><b><?php print_string("feedback", "quiz") ?>:</b></td>
    <td align="left">
        <textarea name="feedback[]" rows="2" cols="50"><?php p($feedbacktext) ?></textarea>
    </td>
</tr>
<tr valign="top">
    <td colspan="2">&nbsp;</td>
</tr>
<?php
    }
// Units.
?>
<tr valign="top">
<td align="right"><b><?php print_string("unit", "quiz") ?>:</b></td>
    <td align="left"><?php
    if (isset($units[0]) && abs($units[0]->multiplier - 1.0) < 0.000001) {
        $unit = $units[0]->unit;
        $firstalternateunit = 1;
    } else {
        $unit = '';
        $firstalternateunit = 0;
    }
    $multiplier = '1.0';
    ?>
    <input type="hidden" name="multiplier[]" value="<?php p($multiplier) ?>" />
    <input align="left" type="text" id="defaultunit" name="unit[]" size="10" value="<?php p($unit) ?>" alt="<?php print_string("unit", "quiz") ?>" />
    <b>(<?php print_string("optional", "quiz") ?>)</b>
    </td>
</tr>
<tr valign="top">
<td></td>
<td align="left"><b><?php print_string("alternativeunits", "quiz") ?>:</b></td>
<td></td>
</tr>
<?php
for ($i = $firstalternateunit; $i < 5 + $firstalternateunit; $i++) {
    if (isset($units[$i])) {
        $multiplier = (float)$units[$i]->multiplier;
        $unit = $units[$i]->unit;
    } else {
        $multiplier = '';
        $unit = '';
    }
?>
<tr valign="top">
<td></td>
    <td align="left">
        <b><?php print_string("multiplier", "quiz") ?>:</b>
        <input type="text" size="10" name="multiplier[]" value="<?php p($multiplier) ?>"
                alt="<?php print_string("multiplier", "quiz") ?>" />
        <b>&nbsp;&nbsp;&nbsp;<?php print_string("unit", "quiz") ?>:</b>
        <input type="text" name="unit[]" size="5" value="<?php p($unit) ?>" />
    </td>
</tr>
<?php
} /// END for

$QTYPES[$question->qtype]->print_replacement_options($question, $course, $contextquiz);
$QTYPES[$question->qtype]->print_question_form_end($question);
?>
